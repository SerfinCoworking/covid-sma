<%= render 'shared/errors', object: @prescription %>

<%= simple_form_for @prescription, html: {class: "form-inline"} do |f| %>
  <%= f.input :professional_id,
                    label: 'Doctor',
                    label_method: :full_name,
                    value_method: :id,
                    collection: @professionals,
                    include_blank: false,
                    input_html: { class: 'chosen-select', id: 'professional_id' },
                    prompt: 'Seleccionar un doctor o crear uno nuevo'
  %><br><br>
  <%= f.hint 'No seleccione ningún doctor para crear uno nuevo.', id: 'professional-hint', style: "display: none" %>

  <%= f.simple_fields_for :professional, html: {class: "form-inline"} do |form_professional| %>
    <%= render "professional_fields", :f => form_professional %>
  <% end %><br>

  <%= f.input :patient_id,
                    label: 'Paciente',
                    label_method: :full_info,
                    value_method: :id,
                    collection: @patients,
                    include_blank: false,
                    input_html: { class: 'chosen-select', id: 'patient_id' },
                    prompt: 'Seleccionar un paciente o crear uno nuevo'
  %><br><br>
  <%= f.hint 'No seleccione ningún paciente para crear uno nuevo.', id: 'patientHint', style: "display: none" %>

  <%= f.simple_fields_for :patient, html: { class: 'form-inline' } do |form_patient| %>
    <%= render "patient_fields", :f => form_patient %>
  <% end %><br>

  <label>Medicación</label>
  <div id="quantity-medications">
      <%= f.simple_fields_for :quantity_medications, html: {class: "form-inline"} do |form_quantity| %>
        <%= render "quantity_medication_fields", :f => form_quantity %>
      <% end %>
      <div class="links">
        <%= link_to_add_association f, :quantity_medications, class: 'btn btn-default btn-sm' do %>
            <%= content_tag(:span, '', class: 'glyphicon glyphicon-plus') %>
        <% end %>
      </div>
      <p class="count">Total: <span><%= @prescription.quantity_medications.count %></span></p>
  </div>
  <br><br>


  <%= f.input :observation, label: 'Observaciones', as: :text %><br><br>
  <%= f.input :date_received, label: 'Fecha recibida',
                              as: :string,
                              required: true,
                              :placeholder => "Seleccionar fecha",
                              input_html: {class: "form-control"},
                              label: "Fecha recibida: ",
                              html5: false
                              %>
  <%= f.input :date_processed, label: 'Fecha procesada',
                              as: :string,
                              required: true,
                              :placeholder => "Seleccionar fecha",
                              input_html: {class: "form-control"},
                              label: "Fecha procesada: "%><br><br>

  <%= link_to 'Volver', prescriptions_path, class: 'btn btn-default', tabindex: "-1" %>
  <%= f.button :submit, 'Cargar prescripción', class: 'btn btn-primary', style: "margin-left: 30%" %>
<% end %>
